{% extends "layouts/base.html" %}
{%load static %}
{%block title%}Website Dashboard{%endblock%}

{%block content %}


<ul class="nav nav-tabs" id="charts-tabs">
  <li><a href="#line-chart" data-toggle="tab">Line Chart</a></li>
  <li class="active"><a data-chart="bubble" href="#bubble-chart" data-toggle="tab">Bubble Chart</a></li>
  <li><a href="#bar-chart" data-toggle="tab">Bar Chart</a></li>
</ul>

<div class="tab-content">
  <div class="tab-pane" id="line-chart"></div>
  <div class="tab-pane active" id="bubble-chart">
      <svg style="height:800px;width:100%"></svg>
  </div>
  <div class="tab-pane" id="bar-chart">
      <svg style="height:500px;width:100%"></svg>
  </div>
</div>

<script>
var json_bubble = {{bubble_json|safe}};
function drawBubbleChart() { 
    nv.addGraph(function() {
        var chart = nv.models.scatterChart()
                      .showDistX(true)
                      .showDistY(true)
                      .showControls(true)
                      .color(d3.scale.category20().range());
        
        chart.xAxis.tickFormat(d3.format('.02f'))
        chart.yAxis.tickFormat(d3.format('.02f'))
        
        d3.select('#bubble-chart svg')
            .datum(json_bubble)
          .transition().duration(500)
            .call(chart);
        
        nv.utils.windowResize(chart.update);
        
        console.log(randomData(4,40));
        
        return chart;
    });
    
    function randomData(groups, points) { //# groups,# points per group
      var data = [],
          shapes = ['circle', 'cross', 'triangle-up', 'triangle-down', 'diamond', 'square'],
          random = d3.random.normal();
    
      for (i = 0; i < groups; i++) {
        data.push({
          key: 'Group ' + i,
          values: []
        });
    
        for (j = 0; j < points; j++) {
          data[i].values.push({
            x: random()
          , y: random()
          , size: Math.random()
          //, shape: shapes[j % 6]
          });
        }
      }
    
      return data;
    }

}





/*
var testdata = [
  {
    "key" : "Quantity" ,
    "bar": true,
    "values" : [ [ 1136005200000 , 1271000.0] , [ 1138683600000 , 1271000.0] , [ 1141102800000 , 1271000.0] , [ 1143781200000 , 0] , [ 1146369600000 , 0] , [ 1149048000000 , 0] , [ 1151640000000 , 0] , [ 1154318400000 , 0] , [ 1156996800000 , 0] , [ 1159588800000 , 3899486.0] , [ 1162270800000 , 3899486.0] , [ 1164862800000 , 3899486.0] , [ 1167541200000 , 3564700.0] , [ 1170219600000 , 3564700.0] , [ 1172638800000 , 3564700.0] , [ 1175313600000 , 2648493.0] , [ 1177905600000 , 2648493.0] , [ 1180584000000 , 2648493.0] , [ 1183176000000 , 2522993.0] , [ 1185854400000 , 2522993.0] , [ 1188532800000 , 2522993.0] , [ 1191124800000 , 2906501.0] , [ 1193803200000 , 2906501.0] , [ 1196398800000 , 2906501.0] , [ 1199077200000 , 2206761.0] , [ 1201755600000 , 2206761.0] , [ 1204261200000 , 2206761.0] , [ 1206936000000 , 2287726.0] , [ 1209528000000 , 2287726.0] , [ 1212206400000 , 2287726.0] , [ 1214798400000 , 2732646.0] , [ 1217476800000 , 2732646.0] , [ 1220155200000 , 2732646.0] , [ 1222747200000 , 2599196.0] , [ 1225425600000 , 2599196.0] , [ 1228021200000 , 2599196.0] , [ 1230699600000 , 1924387.0] , [ 1233378000000 , 1924387.0] , [ 1235797200000 , 1924387.0] , [ 1238472000000 , 1756311.0] , [ 1241064000000 , 1756311.0] , [ 1243742400000 , 1756311.0] , [ 1246334400000 , 1743470.0] , [ 1249012800000 , 1743470.0] , [ 1251691200000 , 1743470.0] , [ 1254283200000 , 1519010.0] , [ 1256961600000 , 1519010.0] , [ 1259557200000 , 1519010.0] , [ 1262235600000 , 1591444.0] , [ 1264914000000 , 1591444.0] , [ 1267333200000 , 1591444.0] , [ 1270008000000 , 1543784.0] , [ 1272600000000 , 1543784.0] , [ 1275278400000 , 1543784.0] , [ 1277870400000 , 1309915.0] , [ 1280548800000 , 1309915.0] , [ 1283227200000 , 1309915.0] , [ 1285819200000 , 1331875.0] , [ 1288497600000 , 1331875.0] , [ 1291093200000 , 1331875.0] , [ 1293771600000 , 1331875.0] , [ 1296450000000 , 1154695.0] , [ 1298869200000 , 1154695.0] , [ 1301544000000 , 1194025.0] , [ 1304136000000 , 1194025.0] , [ 1306814400000 , 1194025.0] , [ 1309406400000 , 1194025.0] , [ 1312084800000 , 1194025.0] , [ 1314763200000 , 1244525.0] , [ 1317355200000 , 475000.0] , [ 1320033600000 , 475000.0] , [ 1322629200000 , 475000.0] , [ 1325307600000 , 690033.0] , [ 1327986000000 , 690033.0] , [ 1330491600000 , 690033.0] , [ 1333166400000 , 514733.0] , [ 1335758400000 , 514733.0]]
  },
  {
    "key" : "Price" ,
    "values" : [ [ 1136005200000 , 71.89] , [ 1138683600000 , 75.51] , [ 1141102800000 , 68.49] , [ 1143781200000 , 62.72] , [ 1146369600000 , 70.39] , [ 1149048000000 , 59.77] , [ 1151640000000 , 57.27] , [ 1154318400000 , 67.96] , [ 1156996800000 , 67.85] , [ 1159588800000 , 76.98] , [ 1162270800000 , 81.08] , [ 1164862800000 , 91.66] , [ 1167541200000 , 84.84] , [ 1170219600000 , 85.73] , [ 1172638800000 , 84.61] , [ 1175313600000 , 92.91] , [ 1177905600000 , 99.8] , [ 1180584000000 , 121.191] , [ 1183176000000 , 122.04] , [ 1185854400000 , 131.76] , [ 1188532800000 , 138.48] , [ 1191124800000 , 153.47] , [ 1193803200000 , 189.95] , [ 1196398800000 , 182.22] , [ 1199077200000 , 198.08] , [ 1201755600000 , 135.36] , [ 1204261200000 , 125.02] , [ 1206936000000 , 143.5] , [ 1209528000000 , 173.95] , [ 1212206400000 , 188.75] , [ 1214798400000 , 167.44] , [ 1217476800000 , 158.95] , [ 1220155200000 , 169.53] , [ 1222747200000 , 113.66] , [ 1225425600000 , 107.59] , [ 1228021200000 , 92.67] , [ 1230699600000 , 85.35] , [ 1233378000000 , 90.13] , [ 1235797200000 , 89.31] , [ 1238472000000 , 105.12] , [ 1241064000000 , 125.83] , [ 1243742400000 , 135.81] , [ 1246334400000 , 142.43] , [ 1249012800000 , 163.39] , [ 1251691200000 , 168.21] , [ 1254283200000 , 185.35] , [ 1256961600000 , 188.5] , [ 1259557200000 , 199.91] , [ 1262235600000 , 210.732] , [ 1264914000000 , 192.063] , [ 1267333200000 , 204.62] , [ 1270008000000 , 235.0] , [ 1272600000000 , 261.09] , [ 1275278400000 , 256.88] , [ 1277870400000 , 251.53] , [ 1280548800000 , 257.25] , [ 1283227200000 , 243.1] , [ 1285819200000 , 283.75] , [ 1288497600000 , 300.98] , [ 1291093200000 , 311.15] , [ 1293771600000 , 322.56] , [ 1296450000000 , 339.32] , [ 1298869200000 , 353.21] , [ 1301544000000 , 348.5075] , [ 1304136000000 , 350.13] , [ 1306814400000 , 347.83] , [ 1309406400000 , 335.67] , [ 1312084800000 , 390.48] , [ 1314763200000 , 384.83] , [ 1317355200000 , 381.32] , [ 1320033600000 , 404.78] , [ 1322629200000 , 382.2] , [ 1325307600000 , 405.0] , [ 1327986000000 , 456.48] , [ 1330491600000 , 542.44] , [ 1333166400000 , 599.55] , [ 1335758400000 , 583.98]]
  }
].map(function(series) {
  series.values = series.values.map(function(d) { return {x: d[0], y: d[1] } });
  return series;
});

nv.addGraph(function() {
     var chart = nv.models.multiBarChart();
     chart.stacked(true);
     chart.xAxis
         .tickFormat(function(d) { return d3.time.format('%b %d')(new Date(d)); });
 
     chart.yAxis
         .tickFormat(d3.format(',.1f'));
 
     d3.select('#bar-chart svg')
         .datum(fakeActivityByDate())
       .transition().duration(500).call(chart);
 
     nv.utils.windowResize(chart.update);
 
     return chart;
 });
 
 
function days(num) {
  return num*60*60*1000*24
}
 /**************************************
  * Simple test data generator
  * /

function fakeActivityByDate() {
   var lineData = [];
   var lineData2 = [];
   var y=1;
   var start_date = new Date() - days(70); // one year ago

   for (var i = 0; i < 100; i++) {
     lineData.push({x: new Date(start_date + days(i)), y: y});
     y=y+Math.floor((Math.random()*5)-3);
   }
   
   start_date = new Date() - days(70); // one year ago
   y = 1;
   for (var i = 0; i < 100; i++) {
     lineData2.push({x: new Date(start_date + days(i)), y: y});
     y=y+Math.floor((Math.random()*20)-3);
   }

   return [
     {
       values: lineData,
       key: 'Groupon',
     },
     {
       values: lineData2,
       key: 'Facebook',
     }
   ];
} */
</script>
{%endblock%}


{%block sidebar%}
<li><h5>Filter</h5></li>
<h6>Channel</h6>
<select name="filter-channel" data-placeholder="select one or more channels" multiple="multiple" class="chzn-select">
<option selected="selected" value="_all">all</option>
{% for channel in channels %}
<option value="{{channel.id}}">{{channel.name}}</option>
{% endfor %}
</select>


<h6>Campaigns</h6>
<select name="filter-campaign" data-placeholder="select one or more campaigns" multiple="multiple" class="chzn-select">
<option selected="selected" value="_all">all</option>
{% for campaign in campaigns %}
<option value="{{campaign.id}}">{{campaign.name}}</option>
{% endfor %}
</select>


<h6>Partner</h6>
<select name="filter-partner" data-placeholder="select one or more partner" multiple="multiple" class="chzn-select">
<option selected="selected" value="_all">all</option>
{% for partner in partners %}
<option value="{{partner.id}}">{{partner.name}}</option>
{% endfor %}
</select>

{%endblock%}


{%block head_extra %}
<link href="/static/js/nv/src/nv.d3.css" rel="stylesheet">
<link href="/static/chosen/chosen.css" rel="stylesheet">
<link href="/static/styles/charts.css" rel="stylesheet">
<script src="/static/chosen/chosen.jquery.js"></script>
<!--<script src="/static/js/d3.v3.min.js"></script>-->
<script src="/static/js/nv/lib/d3.v2.js"></script>
<script src="/static/js/nv/nv.d3.js"></script>

<!--<script src="/static/js/app/src/charts.js"></script>-->
<script src="/static/js/app/src/main.js"></script>

{%endblock%}
