// Generated by CoffeeScript 1.6.2
(function() {
  $(document).ready(function() {
    var doMetric, loadSideBar;

    $('#kpi-board').load('/websites/kpi');
    doMetric = function(e) {
      return $.post("/websites/set_metric", $(this).serialize()).done(function(data) {
        return drawBarNew();
      });
    };
    $("#metric-left").change(doMetric);
    $("#metric-right").change(doMetric);
    $('input[name="seperation"]').change(function(e) {
      return $.post("/websites/set_seperation", $(this).serialize()).done(function(data) {
        return drawBarNew();
      });
    });
    $('#charts-tabs a').click(function(e) {
      $(this).tab('show');
      window.location.hash = '#!' + this.hash;
      if ($(this).attr('data-chart') === 'bar') {
        return $.post("/websites/set_seperation", 'seperation=aggregated').done(function(data) {
          return drawBarNew();
        });
      }
    });
    loadSideBar = function() {
      return $('#sidebar').load('/websites/sidebar', function() {
        drawCalendar();
        $('.chzn-select').chosen();
        return $('#btn-filter').click(function(e) {
          e.preventDefault();
          return $.post("/websites/filter", $("#filter-form").serialize()).done(function(data) {
            $('#kpi-board').load('/websites/kpi');
            return drawBarNew();
          });
        });
      });
    };
    $('.chzn-select').chosen();
    return loadSideBar();
  });

}).call(this);
